{"version":3,"file":"index.umd.min.js","sources":["../node_modules/string-convert/camel2hyphen.js","../node_modules/json2mq/index.js","../src/store.js","../src/helpers.js","../src/component.js","../src/index.js"],"sourcesContent":["var camel2hyphen = function (str) {\n  return str\n          .replace(/[A-Z]/g, function (match) {\n            return '-' + match.toLowerCase();\n          })\n          .toLowerCase();\n};\n\nmodule.exports = camel2hyphen;","var camel2hyphen = require('string-convert/camel2hyphen');\n\nvar isDimension = function (feature) {\n  var re = /[height|width]$/;\n  return re.test(feature);\n};\n\nvar obj2mq = function (obj) {\n  var mq = '';\n  var features = Object.keys(obj);\n  features.forEach(function (feature, index) {\n    var value = obj[feature];\n    feature = camel2hyphen(feature);\n    // Add px to dimension features\n    if (isDimension(feature) && typeof value === 'number') {\n      value = value + 'px';\n    }\n    if (value === true) {\n      mq += feature;\n    } else if (value === false) {\n      mq += 'not ' + feature;\n    } else {\n      mq += '(' + feature + ': ' + value + ')';\n    }\n    if (index < features.length-1) {\n      mq += ' and '\n    }\n  });\n  return mq;\n};\n\nvar json2mq = function (query) {\n  var mq = '';\n  if (typeof query === 'string') {\n    return query;\n  }\n  // Handling array of media queries\n  if (query instanceof Array) {\n    query.forEach(function (q, index) {\n      mq += obj2mq(q);\n      if (index < query.length-1) {\n        mq += ', '\n      }\n    });\n    return mq;\n  }\n  // Handling single media query\n  return obj2mq(query);\n};\n\nmodule.exports = json2mq;","import { ref, readonly, computed } from \"vue\";\nimport { convertBreakpointsToMediaQueries, subscribeToMediaQuery, listeners, sanitiseBreakpoints, selectBreakpoints } from \"./helpers\";\n\nexport const DEFAULT_BREAKPOINTS = {\n\t\t\t\txs: 576,\n\t\t\t\tsm: 768,\n\t\t\t\tmd: 992,\n\t\t\t\tlg: 1200,\n\t\t\t\txl: 1400,\n\t\t\t\txxl: Infinity,\n\t\t\t}\n\nconst state = {\n  mqAvailableBreakpoints: ref({}),\n  currentBreakpoint: ref(\"\")\n}\n\nexport const setAvailableBreakpoints = (v) => state.mqAvailableBreakpoints.value = v;\nexport const mqAvailableBreakpoints = readonly(state.mqAvailableBreakpoints);\n\nexport const setCurrentBreakpoint = (v) => state.currentBreakpoint.value = v;\nexport const currentBreakpoint = readonly(state.currentBreakpoint);\n\nexport function updateBreakpoints(breakpoints) {\n  // Remove any existing MQ listeners\n  for (let i = listeners.length - 1; i >= 0; i--) {\n    const { mql, cb } = listeners[i];\n    mql.removeEventListener('change', cb);\n    listeners.splice(i,1);\n  }\n\n  sanitiseBreakpoints(breakpoints);\n\n  // Save new breakpoints to reactive variable\n  setAvailableBreakpoints(breakpoints);\n  // Create css media queries from breakpoints\n  const mediaQueries = convertBreakpointsToMediaQueries(breakpoints);\n\n  // Add new MQ listeners\n  for (const key in mediaQueries) {\n    const mediaQuery = mediaQueries[key];\n    const enter = () => { setCurrentBreakpoint(key) }\n    subscribeToMediaQuery(mediaQuery, enter)\n  }\n}\n\nexport function shouldRender(mq) {\n        const isMqArray = Array.isArray(mq);\n        const isMqPlus = !isMqArray.value && /\\+$/.test(mq) === true;\n        const isMqMinus = !isMqArray.value && /-$/.test(mq) === true;\n        const isMqRange = !isMqArray.value && /^\\w*-\\w*/.test(mq) === true;\n        const activeBreakpoints = computed(() => {\n            if (isMqArray) return mq;\n            else if (!isMqPlus && !isMqMinus && !isMqRange) return [mq];\n            else {\n                return selectBreakpoints({mqProp: mq, isMqPlus: { value: isMqPlus}, isMqMinus: { value: isMqMinus}, isMqRange: { value: isMqRange} });\n            }\n        });\n\n        return activeBreakpoints.value.includes(currentBreakpoint.value)\n}","import json2mq from 'json2mq';\nimport { mqAvailableBreakpoints } from \"./store\";\nexport const listeners = [];\n\nexport function convertBreakpointsToMediaQueries(breakpoints) {\n  const keys = Object.keys(breakpoints)\n  const values = keys.map(key => breakpoints[key])\n  const breakpointValues = [0, ...values.slice(0, -1)]\n  const mediaQueries = breakpointValues.reduce((accumulator, current, index) => {\n    const options = Object.assign(\n      {\n        minWidth: current,\n      },\n      index < keys.length - 1 ? { maxWidth: breakpointValues[index+1] - 1 } : {}\n    )\n    const mediaQuery = json2mq(options)\n    return Object.assign(\n      accumulator,\n      {\n        [keys[index]]: mediaQuery,\n      }\n    )\n  }, {});\n  return mediaQueries\n}\n\nexport function selectBreakpoints({mqProp, isMqPlus = {value: false}, isMqMinus = {value: false}, isMqRange = {value: false}}) {\n  const ents = Object.entries(mqAvailableBreakpoints.value);\n  if (ents.length === 0) return [];\n  if (isMqPlus.value) mqProp = mqProp.replace(/\\+$/,\"\");\n  else if (isMqMinus.value) mqProp = mqProp.replace(/-$/,\"\");\n  else if (isMqRange.value) {\n    mqProp = mqProp.split(\"-\");\n    if (!mqProp || mqProp.length !== 2) throw new Error(\"Invalid MQ range provided\");\n  }\n  let eligible;\n  if (isMqRange.value) {\n    let from = ents.find(([key,value]) => key == mqProp[0].trim());\n    if (!from || from.length === 0) throw new Error('Range from breakpoint (' + mqProp[0].trim() + ') not found');\n    let to = ents.find(([key,value]) => key == mqProp[1].trim());\n    if (!to || to.length === 0) throw new Error('Range to breakpoint (' + mqProp[1].trim() + ') not found');\n    if (from[1] > to[1]) [from,to] = [to,from];\n    eligible = ents.filter(([key,value]) => value >= from[1] && value <= to[1]);\n  }\n  else {\n    const base = ents.find(([key,value]) => key == mqProp);\n    if (isMqPlus.value) eligible = ents.filter(([key,value]) => value >= base[1]);\n    else if (isMqMinus.value) eligible = ents.filter(([key,value]) => value <= base[1]);\n  }\n  eligible.sort((a,b) => a[1] - b[1]);\n  return eligible.map(el => el[0]);\n}\n\nexport function subscribeToMediaQuery(mediaQuery, enter) {\n  const mql = window.matchMedia(mediaQuery)\n  const cb = ({ matches }) => {\n    if (matches) enter()\n  }\n  listeners.push({mql, cb});\n  mql.addEventListener('change', cb) //subscribing\n  cb(mql) //initial trigger\n}\n\nexport function sanitiseBreakpoints(breakpoints) {\n  for (let bp in breakpoints) {\n    if (!['string','number'].includes(typeof bp) || !bp ) throw new Error(\"Invalid or missing breakpoint key\");\n    if (typeof breakpoints[bp] === 'string') breakpoints[bp] = parseFloat(breakpoints[bp].replace(/[^0-9]/g,\"\"));\n    if (typeof breakpoints[bp] !== 'number' || breakpoints[bp] < 0) throw new Error(\"Invalid breakpoint value for \" + bp + \". Please use a valid number.\");\n    if (!breakpoints[bp]) throw new Error(\"No valid breakpoint value for \" + bp + \" was found\");\n  }\n}","// USAGE // mq-layout(mq=\"lg\") // p Iâ€™m lg\nimport {\n    selectBreakpoints\n} from \"./helpers\";\nimport {\n    currentBreakpoint,\n    shouldRender\n} from \"./store\";\nimport {\n    computed,\n    h,\n    Transition,\n    TransitionGroup\n} from \"vue\";\n\nexport default {\n    name: \"MqLayout\",\n    props: {\n        mq: {\n            type: [String,Array]\n        },\n        tag: {\n            type: String,\n            default: \"div\"\n        },\n        group: {\n            type: Boolean,\n            default: false\n        }\n    },\n    setup(props, context) {\n        const defaultOptions = {\n            name: \"fade\",\n            mode: \"out-in\"\n        }\n        const isMqArray = computed(() => Array.isArray(props.mq));\n        const isMqPlus = computed(\n            () => !isMqArray.value && /\\+$/.test(props.mq) === true\n        );\n        const isMqMinus = computed(\n            () => !isMqArray.value && /-$/.test(props.mq) === true\n        );\n        const isMqRange = computed(\n            () => !isMqArray.value && /^\\w*-\\w*/.test(props.mq) === true\n        );\n\n        const activeBreakpoints = computed(() => {\n            if (isMqArray.value) return props.mq;\n            else if (!isMqPlus.value && !isMqMinus.value && !isMqRange.value) return [props.mq];\n            else {\n                return selectBreakpoints({mqProp: props.mq, isMqPlus, isMqMinus, isMqRange });\n            }\n        });\n\n        const shouldRenderChildren = computed(() =>\n            activeBreakpoints.value.includes(currentBreakpoint.value)\n        );\n\n\n        const renderSlots = (tag) => {\n            let slots = [];\n            for (let slot in context.slots) {\n                if (!props.group && slots.length > 0) return slots;\n                let shouldRenderSlot = computed(() => shouldRender(slot.split(\":\")[0]));\n                if (shouldRenderSlot.value) {\n                    slots.push(h(tag ? tag : context.slots[slot],{ key: slot }, tag ? context.slots[slot]() : undefined));\n                }\n            }\n            return slots;\n        }\n        if (context.slots.default) {\n            return () =>\n            shouldRenderChildren.value ?\n            h(props.tag, {}, context.slots.default()) :\n            h();\n        }\n        else {\n            return () => {\n                const transitionOptions = {...defaultOptions, ...context.attrs };\n                const el = props.group ? TransitionGroup : Transition;\n                return h(el, transitionOptions, renderSlots(props.tag))\n            }\n        }\n    }\n};\n","import MqLayout from './component';\nimport { setCurrentBreakpoint, currentBreakpoint, updateBreakpoints, DEFAULT_BREAKPOINTS } from \"./store\";\nimport { readonly } from \"vue\";\n\nconst install = function (app, { breakpoints = DEFAULT_BREAKPOINTS, defaultBreakpoint = 'sm' } = {}) {  \n  let hasSetupListeners = false\n  setCurrentBreakpoint(defaultBreakpoint);\n\n  app.provide('updateBreakpoints', updateBreakpoints);\n  app.provide('mq', readonly(currentBreakpoint));\n\n  // Init reactive component\n  app.mixin({\n    computed: {\n      $mq() {\n        return currentBreakpoint.value;\n      }\n    },\n    mounted() {\n      if (!hasSetupListeners) {\n        updateBreakpoints(breakpoints)\n        hasSetupListeners = true\n      }\n    }\n  })\n\n  app.config.globalProperties.$mqAvailableBreakpoints = breakpoints;\n  app.component('MqLayout', MqLayout)\n}\n\nexport default {\n  install\n}"],"names":["str","replace","match","toLowerCase","obj2mq","obj","mq","features","Object","keys","forEach","feature","index","value","test","isDimension","camel2hyphen","length","query","Array","q","DEFAULT_BREAKPOINTS","xs","sm","md","lg","xl","xxl","Infinity","state","mqAvailableBreakpoints","ref","currentBreakpoint","readonly","setCurrentBreakpoint","v","updateBreakpoints","breakpoints","i","listeners","mql","cb","removeEventListener","splice","bp","includes","Error","parseFloat","sanitiseBreakpoints","mediaQueries","values","map","key","breakpointValues","slice","reduce","accumulator","current","options","assign","minWidth","maxWidth","mediaQuery","json2mq","convertBreakpointsToMediaQueries","enter","window","matchMedia","matches","push","addEventListener","subscribeToMediaQuery","selectBreakpoints","eligible","mqProp","isMqPlus","isMqMinus","isMqRange","ents","entries","split","from","find","trim","to","filter","base","sort","a","b","el","name","props","type","String","tag","group","Boolean","setup","context","defaultOptions","mode","isMqArray","computed","isArray","activeBreakpoints","shouldRenderChildren","renderSlots","slots","slot","shouldRender","h","undefined","transitionOptions","attrs","TransitionGroup","Transition","install","app","defaultBreakpoint","hasSetupListeners","provide","mixin","$mq","mounted","config","globalProperties","$mqAvailableBreakpoints","component","MqLayout"],"mappings":"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"}