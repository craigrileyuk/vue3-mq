{"version":3,"file":"index.umd.min.js","sources":["../node_modules/string-convert/camel2hyphen.js","../node_modules/json2mq/index.js","../src/store.js","../src/helpers.js","../src/component.js","../src/index.js"],"sourcesContent":["var camel2hyphen = function (str) {\n  return str\n          .replace(/[A-Z]/g, function (match) {\n            return '-' + match.toLowerCase();\n          })\n          .toLowerCase();\n};\n\nmodule.exports = camel2hyphen;","var camel2hyphen = require('string-convert/camel2hyphen');\n\nvar isDimension = function (feature) {\n  var re = /[height|width]$/;\n  return re.test(feature);\n};\n\nvar obj2mq = function (obj) {\n  var mq = '';\n  var features = Object.keys(obj);\n  features.forEach(function (feature, index) {\n    var value = obj[feature];\n    feature = camel2hyphen(feature);\n    // Add px to dimension features\n    if (isDimension(feature) && typeof value === 'number') {\n      value = value + 'px';\n    }\n    if (value === true) {\n      mq += feature;\n    } else if (value === false) {\n      mq += 'not ' + feature;\n    } else {\n      mq += '(' + feature + ': ' + value + ')';\n    }\n    if (index < features.length-1) {\n      mq += ' and '\n    }\n  });\n  return mq;\n};\n\nvar json2mq = function (query) {\n  var mq = '';\n  if (typeof query === 'string') {\n    return query;\n  }\n  // Handling array of media queries\n  if (query instanceof Array) {\n    query.forEach(function (q, index) {\n      mq += obj2mq(q);\n      if (index < query.length-1) {\n        mq += ', '\n      }\n    });\n    return mq;\n  }\n  // Handling single media query\n  return obj2mq(query);\n};\n\nmodule.exports = json2mq;","import { ref, readonly } from \"vue\";\nimport { convertBreakpointsToMediaQueries, subscribeToMediaQuery, listeners } from \"./helpers\";\nconst state = {\n  mqAvailableBreakpoints: ref({}),\n  currentBreakpoint: ref(\"\")\n}\n\nexport const setAvailableBreakpoints = (v) => state.mqAvailableBreakpoints.value = v;\nexport const mqAvailableBreakpoints = readonly(state.mqAvailableBreakpoints);\n\nexport const setCurrentBreakpoint = (v) => state.currentBreakpoint.value = v;\nexport const currentBreakpoint = readonly(state.currentBreakpoint);\n\nexport function updateBreakpoints(breakpoints) {\n  // Remove any existing MQ listeners\n  for (let i = listeners.length - 1; i >= 0; i--) {\n    const { mql, cb } = listeners[i];\n    mql.removeEventListener('change', cb);\n    listeners.splice(i,1);\n  }\n\n  // Save new breakpoints to reactive variable\n  setAvailableBreakpoints(breakpoints);\n  // Create css media queries from breakpoints\n  const mediaQueries = convertBreakpointsToMediaQueries(breakpoints);\n\n  // Add new MQ listeners\n  for (const key in mediaQueries) {\n    const mediaQuery = mediaQueries[key];\n    const enter = () => { setCurrentBreakpoint(key) }\n    subscribeToMediaQuery(mediaQuery, enter)\n  }\n}","import json2mq from 'json2mq';\nimport { mqAvailableBreakpoints } from \"./store\";\nexport const listeners = [];\n\nexport function convertBreakpointsToMediaQueries(breakpoints) {\n  const keys = Object.keys(breakpoints)\n  const values = keys.map(key => breakpoints[key])\n  const breakpointValues = [0, ...values.slice(0, -1)]\n  const mediaQueries = breakpointValues.reduce((accumulator, current, index) => {\n    const options = Object.assign(\n      {\n        minWidth: current,\n      },\n      index < keys.length - 1 ? { maxWidth: breakpointValues[index+1] - 1 } : {}\n    )\n    const mediaQuery = json2mq(options)\n    return Object.assign(\n      accumulator,\n      {\n        [keys[index]]: mediaQuery,\n      }\n    )\n  }, {});\n  return mediaQueries\n}\n\nexport function selectBreakpoints({mqProp, isMqPlus = {value: false}, isMqMinus = {value: false}, isMqRange = {value: false}}) {\n  const ents = Object.entries(mqAvailableBreakpoints.value);\n  if (ents.length === 0) return [];\n  if (isMqPlus.value) mqProp = mqProp.replace(/\\+$/,\"\");\n  else if (isMqMinus.value) mqProp = mqProp.replace(/-$/,\"\");\n  else if (isMqRange.value) {\n    mqProp = mqProp.split(\"-\");\n    if (!mqProp || mqProp.length !== 2) throw new Error(\"Invalid MQ range provided\");\n  }\n  let eligible;\n  if (isMqRange.value) {\n    let from = ents.find(([key,value]) => key == mqProp[0].trim());\n    if (!from || from.length === 0) throw new Error('Range from breakpoint (' + mqProp[0].trim() + ') not found');\n    let to = ents.find(([key,value]) => key == mqProp[1].trim());\n    if (!to || to.length === 0) throw new Error('Range to breakpoint (' + mqProp[1].trim() + ') not found');\n    if (from[1] > to[1]) [from,to] = [to,from];\n    eligible = ents.filter(([key,value]) => value >= from[1] && value <= to[1]);\n  }\n  else {\n    const base = ents.find(([key,value]) => key == mqProp);\n    if (isMqPlus.value) eligible = ents.filter(([key,value]) => value >= base[1]);\n    else if (isMqMinus.value) eligible = ents.filter(([key,value]) => value <= base[1]);\n  }\n  eligible.sort((a,b) => a[1] - b[1]);\n  return eligible.map(el => el[0]);\n}\n\nexport function subscribeToMediaQuery(mediaQuery, enter) {\n  const mql = window.matchMedia(mediaQuery)\n  const cb = ({ matches }) => {\n    if (matches) enter()\n  }\n  listeners.push({mql, cb});\n  mql.addEventListener('change', cb) //subscribing\n  cb(mql) //initial trigger\n}","// USAGE // mq-layout(mq=\"lg\") // p Iâ€™m lg\nimport {\n    selectBreakpoints\n} from \"./helpers\";\nimport {\n    mqAvailableBreakpoints,\n    currentBreakpoint\n} from \"./store\";\nimport {\n    computed,\n    h\n} from \"vue\";\n\nexport default {\n    name: \"MqLayout\",\n    props: {\n        mq: {\n            required: true,\n            type: [Object]\n        },\n        tag: {\n            type: String,\n            default: \"div\"\n        }\n    },\n    setup(props, context) {\n        /*\n        props.mq\n        ['sm','md','lg'] ( respond to sm, md and lg )\n        md+ ( respond to md and above )\n        -lg ( respond to lg and below )\n        sm-lg ( respond to sm, md and lg )\n        */\n        const isMqArray = computed(() => Array.isArray(props.mq));\n        const isMqPlus = computed(\n            () => !isMqArray.value && /\\+$/.test(props.mq) === true\n        );\n        const isMqMinus = computed(\n            () => !isMqArray.value && /-$/.test(props.mq) === true\n        );\n        const isMqRange = computed(\n            () => !isMqArray.value && /^\\w*-\\w*/.test(props.mq) === true\n        );\n        /*\n        const plusModifier = computed(\n            () => !Array.isArray(props.mq) && props.mq.slice(-1) === \"+\"\n        );\n        */\n        // Add a minus modifier here\n        const activeBreakpoints = computed(() => {\n            if (isMqArray.value) return props.mq;\n            else if (!isMqPlus.value && !isMqMinus.value && !isMqRange.value) return [props.mq];\n            else {\n                console.log(mqAvailableBreakpoints.value)\n                return selectBreakpoints({mqProp: props.mq, isMqPlus, isMqMinus, isMqRange });\n            }\n        });\n\n        const shouldRenderChildren = computed(() =>\n            activeBreakpoints.value.includes(currentBreakpoint.value)\n        );\n        return () =>\n            shouldRenderChildren.value ?\n            h(props.tag, {}, context.slots.default()) :\n            h();\n    }\n};\n","import MqLayout from './component';\nimport { setCurrentBreakpoint, currentBreakpoint, updateBreakpoints } from \"./store\";\n\nconst DEFAULT_BREAKPOINTS = {\n  sm: 450,\n  md: 1250,\n  lg: Infinity,\n}\n\nconst install = function (app, { breakpoints = DEFAULT_BREAKPOINTS, defaultBreakpoint = 'sm' } = {}) {  \n  let hasSetupListeners = false\n  setCurrentBreakpoint(defaultBreakpoint);\n\n  app.provide('updateBreakpoints', updateBreakpoints);\n\n  // Init reactive component\n  app.mixin({\n    computed: {\n      $mq() {\n        return currentBreakpoint.value;\n      },\n    },\n    mounted() {\n      if (!hasSetupListeners) {\n        updateBreakpoints(breakpoints)\n        hasSetupListeners = true\n      }\n    }\n  })\n\n  app.config.globalProperties.$mqAvailableBreakpoints = breakpoints;\n  app.component('MqLayout', MqLayout)\n}\n\nexport default {\n  install\n}"],"names":["str","replace","match","toLowerCase","obj2mq","obj","mq","features","Object","keys","forEach","feature","index","value","test","isDimension","camel2hyphen","length","query","Array","q","state","mqAvailableBreakpoints","ref","currentBreakpoint","readonly","setCurrentBreakpoint","v","updateBreakpoints","breakpoints","i","listeners","mql","cb","removeEventListener","splice","mediaQueries","values","map","key","breakpointValues","slice","reduce","accumulator","current","options","assign","minWidth","maxWidth","mediaQuery","json2mq","convertBreakpointsToMediaQueries","enter","window","matchMedia","matches","push","addEventListener","subscribeToMediaQuery","name","props","required","type","tag","String","setup","context","isMqArray","computed","isArray","isMqPlus","isMqMinus","isMqRange","activeBreakpoints","console","log","eligible","mqProp","ents","entries","split","Error","from","find","trim","to","filter","base","sort","a","b","el","selectBreakpoints","shouldRenderChildren","includes","h","slots","DEFAULT_BREAKPOINTS","sm","md","lg","Infinity","install","app","defaultBreakpoint","hasSetupListeners","provide","mixin","$mq","mounted","config","globalProperties","$mqAvailableBreakpoints","component","MqLayout"],"mappings":"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"}